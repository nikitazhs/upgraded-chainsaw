# Notes API

Это API для управления заметками, разработанное на FastAPI. Проект поддерживает регистрацию и авторизацию пользователей (с ролями "User" и "Admin"), CRUD-операции для заметок, логирование действий, юнит-тестирование и контейнеризацию через Docker.

> **Важно:** Конфигурация проекта (например, секретный ключ для JWT и настройки базы данных) теперь управляется через Pydantic (см. `app/config.py`). Рекомендуется создать файл `.env` с необходимыми переменными окружения.

## Функциональность

- **Авторизация и регистрация пользователей:**
  - Регистрация новых пользователей (роль по умолчанию — "User").
  - Авторизация через JWT.
- **Пользователь с ролью "User":**
  - Создает, изменяет и удаляет (мягко) свои заметки.
  - Получает список и отдельную заметку.
- **Пользователь с ролью "Admin":**
  - Получает список всех заметок.
  - Получает заметки конкретного пользователя.
  - Восстанавливает удаленные заметки.
- **Логирование:**  
  Все действия логируются в файл `app.log`.
- **Юнит-тесты:**  
  Тесты написаны с использованием `pytest` и FastAPI TestClient.
- **Контейнеризация:**  
  Проект можно запускать через Docker.

## Структура проекта

notes-api/ ├── app/ │ ├── init.py # Инициализация пакета │ ├── config.py # Конфигурация приложения (настройки через Pydantic) │ ├── database.py # Настройка подключения к базе данных (SQLAlchemy) │ ├── models.py # Определение моделей (User, Note) │ ├── schemas.py # Pydantic-схемы для валидации данных │ ├── crud.py # Функции для работы с базой (CRUD) │ ├── auth.py # Функции для работы с JWT (создание, проверка токенов) │ ├── dependencies.py # Зависимости FastAPI (авторизация, проверка ролей) │ └── main.py # Основное приложение FastAPI и маршруты ├── tests/ │ └── test_main.py # Юнит-тесты ├── Dockerfile # Инструкции для сборки Docker-образа ├── requirements.txt # Список зависимостей ├── .gitignore # Файл исключений для Git └── README.md # Документация проекта

> **Примечание по структуре:**  
> Файл `__init__.py` должен называться именно так, а не `init.py`.

## Запуск проекта

### Локально

1. **Клонировать репозиторий:**
    ```bash
    git clone https://github.com/nikitazhs/upgraded-chainsaw.git
    cd notes-api
    ```

2. **Создать файл `.env`:**  
   Создайте в корне проекта файл `.env` и задайте необходимые переменные (например, `SECRET_KEY` и `DATABASE_URL`). Пример:
    ```env
    SECRET_KEY=your_very_secure_secret_key
    DATABASE_URL=sqlite:///./notes.db
    ```

3. **Создать виртуальное окружение и установить зависимости:**
    ```bash
    python3 -m venv venv
    # Для Linux/Mac:
    source venv/bin/activate
    # Для Windows:
    venv\Scripts\activate
    pip install -r requirements.txt
    ```

4. **Запустить приложение:**
    ```bash
    uvicorn app.main:app --reload
    ```

5. **Доступ к API:**  
   Откройте браузер и перейдите по адресу: [http://localhost:8000/docs](http://localhost:8000/docs)

### С использованием Docker

1. **Собрать Docker-образ:**
    ```bash
    docker build -t notes-api .
    ```

2. **Запустить контейнер:**
    ```bash
    docker run -d --name notes-api -p 8000:8000 notes-api
    ```

3. **Доступ к API:**  
   Откройте браузер и перейдите по адресу: [http://localhost:8000/docs](http://localhost:8000/docs)

## Запуск тестов

Для запуска тестов выполните в корневой директории:
```bash
pytest


